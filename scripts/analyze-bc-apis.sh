#!/bin/bash

# Script para analizar APIs de Business Central disponibles vs utilizadas en n8n

echo "üîç An√°lisis de APIs de Business Central"
echo "======================================"
echo ""

# APIs disponibles en Business Central (extra√≠das del proyecto)
echo "üìã APIs DISPONIBLES en Business Central:"
echo "----------------------------------------"

# APIs v2.0
echo "üîπ APIs v2.0:"
echo "  - PS_Proyectos (50206)"
echo "  - PS_Proyectos_Tareas (50222)"
echo "  - PS_Proyectos_Equipo (50223)"
echo "  - PS_Recursos (50207)"
echo "  - PS_Recursos_Costos (50224)"
echo "  - PS_Calendaro_Periodos_Dias (50225)"
echo "  - PS_HistoricoPlanificacionMes (50221)"
echo "  - PS_Years (50220)"
echo "  - PS_PlanificacionMes (50219)"
echo "  - PS_ObjectivesByDepartaments (50218)"
echo "  - PS_MesesCerrados (50217)"
echo "  - PS_ExpedienteMes (50215)"
echo "  - PS_MovimientosProyectosMes (50214)"
echo "  - PS_DiasDeImputacion (50212)"
echo "  - PS_PresentacionIva (50211)"
echo "  - PS_Links (50210)"
echo "  - PS_Tipologias (50209)"
echo "  - PS_Tecnologias (50208)"
echo "  - PS_MovimientosProyectos (50205)"
echo "  - PS_EquipoProyectos (50204)"
echo "  - PS_Departamentos (50203)"
echo "  - PS_ConfiguracionUsuarios (50202)"
echo "  - PS_ConceptosAnaliticos (50201)"
echo "  - PS_CentrosDeResponsabilidad (50200)"
echo "  - PS_TimeSheetLinesAPI (50736)"
echo ""

# APIs v1.0
echo "üîπ APIs v1.0:"
echo "  - PS_UpdateSeriesAPI (50737)"
echo "  - PS_InsertLine_API (50735)"
echo ""

# APIs de Pages
echo "üîπ APIs de Pages:"
echo "  - PS_TimesheetHeaderAPI (50734)"
echo ""

echo "üìä APIs UTILIZADAS en n8n:"
echo "-------------------------"

# APIs utilizadas en workflow 001
echo "üîπ Workflow 001_sincronizacion_completa_smart:"
echo "  ‚úÖ PS_Proyectos_Tareas (job_task)"
echo "  ‚úÖ PS_Recursos (resource)"
echo "  ‚úÖ PS_Proyectos (job)"
echo "  ‚úÖ PS_Proyectos_Equipo (job_team)"
echo "  ‚úÖ PS_Recursos_Costos (resource_cost)"
echo "  ‚úÖ PS_Calendaro_Periodos_Dias (calendar_period_days)"
echo ""

# APIs utilizadas en workflow 002
echo "üîπ Workflow 002_sync_supabase_to_bc_multi:"
echo "  ‚úÖ PS_TimesheetHeaderAPI (resourcetimesheetheaders)"
echo "  ‚úÖ PS_InsertLine_API (insertlines)"
echo ""

# APIs utilizadas en warmup
echo "üîπ Workflow 000_warmup_credentials:"
echo "  ‚úÖ Companies (endpoint est√°ndar BC)"
echo "  ‚úÖ PS_Proyectos (solo para test)"
echo ""

echo "‚ùå APIs NO UTILIZADAS en n8n:"
echo "----------------------------"

# APIs no utilizadas
echo "üî∏ APIs v2.0 no utilizadas:"
echo "  ‚ùå PS_HistoricoPlanificacionMes (50221)"
echo "  ‚ùå PS_Years (50220)"
echo "  ‚ùå PS_PlanificacionMes (50219)"
echo "  ‚ùå PS_ObjectivesByDepartaments (50218)"
echo "  ‚ùå PS_MesesCerrados (50217)"
echo "  ‚ùå PS_ExpedienteMes (50215)"
echo "  ‚ùå PS_MovimientosProyectosMes (50214)"
echo "  ‚ùå PS_DiasDeImputacion (50212)"
echo "  ‚ùå PS_PresentacionIva (50211)"
echo "  ‚ùå PS_Links (50210)"
echo "  ‚ùå PS_Tipologias (50209)"
echo "  ‚ùå PS_Tecnologias (50208)"
echo "  ‚ùå PS_MovimientosProyectos (50205)"
echo "  ‚ùå PS_EquipoProyectos (50204)"
echo "  ‚ùå PS_Departamentos (50203)"
echo "  ‚ùå PS_ConfiguracionUsuarios (50202)"
echo "  ‚ùå PS_ConceptosAnaliticos (50201)"
echo "  ‚ùå PS_CentrosDeResponsabilidad (50200)"
echo "  ‚ùå PS_TimeSheetLinesAPI (50736)"
echo ""

echo "üî∏ APIs v1.0 no utilizadas:"
echo "  ‚ùå PS_UpdateSeriesAPI (50737)"
echo ""

echo "üìà RESUMEN:"
echo "----------"
echo "Total APIs disponibles: 28"
echo "APIs utilizadas en n8n: 8"
echo "APIs no utilizadas: 20"
echo "Porcentaje de uso: 28.6%"
echo ""

echo "üí° RECOMENDACIONES:"
echo "------------------"
echo "1. ‚úÖ Mantener APIs utilizadas en n8n (8 APIs)"
echo "2. ‚ùå Considerar eliminar APIs no utilizadas (20 APIs)"
echo "3. üîç Revisar si alguna API no utilizada es necesaria para funcionalidad futura"
echo "4. üìù Documentar APIs eliminadas para referencia futura"
echo ""

echo "üóëÔ∏è  APIs CANDIDATAS PARA ELIMINACI√ìN:"
echo "------------------------------------"
echo "Las siguientes APIs pueden ser eliminadas del proyecto BC:"
echo ""
echo "Queries v2.0 (20 APIs):"
echo "  - PS_HistoricoPlanificacionMes"
echo "  - PS_Years"
echo "  - PS_PlanificacionMes"
echo "  - PS_ObjectivesByDepartaments"
echo "  - PS_MesesCerrados"
echo "  - PS_ExpedienteMes"
echo "  - PS_MovimientosProyectosMes"
echo "  - PS_DiasDeImputacion"
echo "  - PS_PresentacionIva"
echo "  - PS_Links"
echo "  - PS_Tipologias"
echo "  - PS_Tecnologias"
echo "  - PS_MovimientosProyectos"
echo "  - PS_EquipoProyectos"
echo "  - PS_Departamentos"
echo "  - PS_ConfiguracionUsuarios"
echo "  - PS_ConceptosAnaliticos"
echo "  - PS_CentrosDeResponsabilidad"
echo "  - PS_TimeSheetLinesAPI"
echo ""
echo "Pages v1.0 (1 API):"
echo "  - PS_UpdateSeriesAPI"
echo ""
echo "Total: 21 APIs pueden ser eliminadas"
