#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "â„¹ï¸  PolÃ­tica de PR: Usa scripts/pr-flow.sh (open/status/rerun-ci/merge/cleanup) para gestionar PRs hacia reset/main."

npm run lint --silent -- --max-warnings=0 || { echo "\nğŸ’¥ Lint fallÃ³"; exit 1; }
# Ejecutar tests localmente ralentiza; delegamos a CI. Mantener este comando comentado o protegido por variable.
if [ "${RUN_LOCAL_TESTS-}" = "1" ]; then
  npm run test --silent || { echo "\nğŸ’¥ Tests fallaron"; exit 1; }
fi

bash scripts/smoke-approval.sh || { echo "\nğŸ’¥ AprobaciÃ³n rota"; exit 1; }
bash scripts/smoke-edit.sh || { echo "\nğŸ’¥ EdiciÃ³n rota"; exit 1; }
bash scripts/smoke-rejected-edit.sh || { echo "\nğŸ’¥ Rejected en ediciÃ³n roto"; exit 1; }
bash scripts/smoke-dashboard.sh || { echo "\nğŸ’¥ BackToDashboard faltante"; exit 1; }
bash scripts/smoke-modals.sh || { echo "\nğŸ’¥ Uso de alert/confirm/prompt detectado"; exit 1; }

echo "âœ… Pre-push OK"

