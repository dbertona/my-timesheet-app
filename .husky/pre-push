#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

npm run lint --silent -- --max-warnings=0 || { echo "\nðŸ’¥ Lint fallÃ³"; exit 1; }
# Ejecutar tests localmente ralentiza; delegamos a CI. Mantener este comando comentado o protegido por variable.
if [ "${RUN_LOCAL_TESTS-}" = "1" ]; then
  npm run test --silent || { echo "\nðŸ’¥ Tests fallaron"; exit 1; }
fi

bash scripts/smoke-approval.sh || { echo "\nðŸ’¥ AprobaciÃ³n rota"; exit 1; }
bash scripts/smoke-edit.sh || { echo "\nðŸ’¥ EdiciÃ³n rota"; exit 1; }
bash scripts/smoke-rejected-edit.sh || { echo "\nðŸ’¥ Rejected en ediciÃ³n roto"; exit 1; }
bash scripts/smoke-dashboard.sh || { echo "\nðŸ’¥ BackToDashboard faltante"; exit 1; }
bash scripts/smoke-modals.sh || { echo "\nðŸ’¥ Uso de alert/confirm/prompt detectado"; exit 1; }

echo "âœ… Pre-push OK"

